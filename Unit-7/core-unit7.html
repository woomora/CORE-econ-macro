<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Labour markets and unemployment</title>
    <meta charset="utf-8" />
    <meta name="author" content="Guillermo Woo-Mora" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/default-fonts.css" rel="stylesheet" />
    <meta name="description" content="An Introduction to xaringan for Presentations: The Basics"/>
    <meta name="generator" content="xaringan and remark.js"/>
    <meta name="github-repo" content="spcanelon/xaringan-basics-and-beyond"/>
    <link href="libs/tile-view/tile-view.css" rel="stylesheet" />
    <script src="libs/tile-view/tile-view.js"></script>
    <link href="libs/panelset/panelset.css" rel="stylesheet" />
    <script src="libs/panelset/panelset.js"></script>
    <script src="libs/clipboard/clipboard.min.js"></script>
    <link href="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.js"></script>
    <script>window.xaringanExtraClipboard(null, {"button":"Copy Code","success":"Copied!","error":"Press Ctrl+C to Copy"})</script>
    <script src="libs/xaringanExtra-webcam/webcam.js"></script>
    <script id="xaringanExtra-webcam-options" type="application/json">{"width":"200","height":"200","margin":"1em"}</script>
    <script src="libs/js-cookie/js.cookie.js"></script>
    <script src="libs/peerjs/peerjs.min.js"></script>
    <script src="libs/tiny.toast/toast.min.js"></script>
    <link href="libs/xaringanExtra-broadcast/broadcast.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-broadcast/broadcast.js"></script>
    <link href="libs/shareon/shareon.min.css" rel="stylesheet" />
    <script src="libs/shareon/shareon.min.js"></script>
    <link href="libs/xaringanExtra-shareagain/shareagain.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-shareagain/shareagain.js"></script>
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Labour markets and unemployment
## Unit 7: Price setting
### Guillermo Woo-Mora
### 30/03/2022

---







---

--

.pull-left[
&lt;img src="imgs/lidl.jpeg" width="100%" style="display: block; margin: auto;" /&gt;
]

--

.pull-right[
&lt;img src="imgs/monoprix.jpeg" width="100%" style="display: block; margin: auto;" /&gt;
]


--

From last class,
--
 interactions between firms and workers determine wages, which are part of a firm’s production costs.

--

Two other key decisions for firms: 

--

- choosing product prices  

--

- quantities to produce

---
# Unit 7. The firm and its customers

--

.pull-left[


&lt;img src="imgs/figure-07-02.svg" width="100%" style="display: block; margin: auto;" /&gt;

]

.pull-right[

- Model of interactions between customers and profit-maximising firms producing differentiated products.


- Factors that affect the firm’s choice of price and quantities produced (costs, price elasticity, market power)

]


---

# Production: Economies of Scale

--

- A firm’s costs depend on its scale of production and the type of production technology it has.

--

- Large firms can be more profitable than small firms because of technological and/or cost advantages.

--

Production function (technology): `\(Y = f(X) = X^{\alpha}\)`.
--
 Inputs increase in a given proportion: `\(\lambda &gt; 0\)`

--

$$ \Rightarrow f(\lambda X) = (\lambda X)^{\alpha} = \lambda^{\alpha} X^{\alpha} = \lambda^{\alpha} f(X) $$

--

| Production | Technology | Homogeneity |
| -----------------------------------------|
| Increases more than proportionally | **Increasing returns to scale** | `\(f(\lambda X) &gt; \lambda f(X) \quad \forall \alpha &gt; 1\)` |
| Increases proportionally | **Constant returns to scale** | `\(f(\lambda X) = \lambda f(X) \quad \alpha = 1\)` |
| Increases less than proportionally | **Decreasing returns to scale** | `\(f(\lambda X) &lt; \lambda f(X) \quad \forall \alpha &lt; 1\)` |

--

- Cost advantages – Large firms can purchase inputs on more favourable terms.

- Demand advantages - Network effects (value of output rises with number of users e.g. software application)

- Large firms can also suffer from diseconomies of scale, e.g. additional layers of bureaucracy due to too many employees.

---
# Cost functions

--

To make pricing and production decisions, managers need to know the costs of production.

--

How total production costs vary with quantity produced. 

--

- **Total cost**: Total cost for each level of output.

--

- **Average cost**: Average cost per unit produced.

--

- **Marginal cost**: the effect on total cost of producing one additional unit of output.

---

--

&lt;img src="imgs/figure-07-06-b.svg" width="50%" style="display: block; margin: auto;" /&gt;

---

&lt;img src="imgs/figure-07-06-c.svg" width="50%" style="display: block; margin: auto;" /&gt;

---

&lt;img src="imgs/figure-07-06-d.svg" width="50%" style="display: block; margin: auto;" /&gt;

---

&lt;img src="imgs/figure-07-06-e.svg" width="50%" style="display: block; margin: auto;" /&gt;

---

&lt;img src="imgs/figure-07-06-f.svg" width="50%" style="display: block; margin: auto;" /&gt;

---

&lt;img src="imgs/figure-07-06-g.svg" width="50%" style="display: block; margin: auto;" /&gt;


---

--

&lt;img src="imgs/figure-07-07-a.svg" width="55%" style="display: block; margin: auto;" /&gt;

---

&lt;img src="imgs/figure-07-07-b.svg" width="55%" style="display: block; margin: auto;" /&gt;

---

&lt;img src="imgs/figure-07-07-c.svg" width="55%" style="display: block; margin: auto;" /&gt;

---

&lt;img src="imgs/figure-07-07-d.svg" width="55%" style="display: block; margin: auto;" /&gt;

---

&lt;img src="imgs/figure-07-07-e.svg" width="55%" style="display: block; margin: auto;" /&gt;

---

&lt;img src="imgs/figure-07-07-f.svg" width="55%" style="display: block; margin: auto;" /&gt;

---

&lt;img src="imgs/figure-07-07-h.svg" width="55%" style="display: block; margin: auto;" /&gt;


---

--

&lt;img src="imgs/figure-07-08-a.svg" width="90%" style="display: block; margin: auto;" /&gt;

---

&lt;img src="imgs/figure-07-08-b.svg" width="90%" style="display: block; margin: auto;" /&gt;

When Q = 20, the average cost is 4,000, but the marginal cost is only 2,200. So if 21 cars rather than 20 are produced, that will reduce the average cost. Average cost is lower at Q = 21.


---

&lt;img src="imgs/figure-07-08-c.svg" width="90%" style="display: block; margin: auto;" /&gt;

At any point, like point A, where AC &gt; MC, the average cost will fall if one more car is produced, so the AC curve slopes downward.

---

&lt;img src="imgs/figure-07-08-d.svg" width="90%" style="display: block; margin: auto;" /&gt;

At point D where Q = 60, the average cost is 3,600, but the cost of producing the 61st car is 4,600. So the average cost of a car will rise if 61 cars are produced. When AC &lt; MC, the average cost curve slopes upward.

---

&lt;img src="imgs/figure-07-08-e.svg" width="90%" style="display: block; margin: auto;" /&gt;

At point B, where the average cost is lowest, the average and marginal costs are equal. The two curves cross. When AC = MC, the AC curve doesn’t slope up or down: it is flat (the slope is zero).

---

# Demand curve

--

Quantity that consumers will buy at each price. 

--

&lt;img src="imgs/figure-07-09.svg" width="75%" style="display: block; margin: auto;" /&gt;

---

# Isoprofit curve

--

`$$\textit{profit} = \textit{total revenue} -  \textit{total cost} = PQ - C(Q)$$`

--


`$$\textit{profit} = Q\cdot (P - \frac{C(Q)}{Q})$$`
--


`$$\textit{profit} = Q\cdot (P - AC)$$`

--

 - Price-quantity combinations that give the same profit. 

--

- Shape of the isoprofit curves will depend on the shape of the average cost curve.

---

&lt;img src="imgs/figure-07-10-a.svg" width="90%" style="display: block; margin: auto;" /&gt;

The lightest blue curve is the firm’s average cost curve. If P = AC, the firm’s economic profit is zero. So the AC curve is also the zero-profit curve: it shows all the combinations of P and Q that give zero economic profit.

---

&lt;img src="imgs/figure-07-10-b.svg" width="90%" style="display: block; margin: auto;" /&gt;

Beautiful Cars has decreasing AC when Q &lt; 40, and increasing AC when Q &gt; 40. When Q is low, it needs a high price to break even. If Q = 40 it could break even with a price of $3,400. For Q &gt; 40, it would need to raise the price again to avoid a loss.

---

&lt;img src="imgs/figure-07-10-c.svg" width="90%" style="display: block; margin: auto;" /&gt;

Beautiful Cars has increasing marginal costs: the upward-sloping line. Remember that the AC curve slopes down if AC &gt; MC, and up if AC &lt; MC. The two curves cross at B, where AC is lowest.

---

&lt;img src="imgs/figure-07-10-d.svg" width="90%" style="display: block; margin: auto;" /&gt;

The darker blue curves show the combinations of P and Q giving higher levels of profit, so points G and K give the same profit.

---

&lt;img src="imgs/figure-07-10-e.svg" width="90%" style="display: block; margin: auto;" /&gt;

At G where the firm makes 23 cars, the price is 6,820 and the average cost is 3,777. The firm makes a profit of 3,043 on each car, and its total profit is 70,000.

---

&lt;img src="imgs/figure-07-10-f.svg" width="90%" style="display: block; margin: auto;" /&gt;

Profit is higher on the curves closer to the top-right corner in the diagram. Point H has the same quantity as K, so the average cost is the same, but the price is higher at H.

---
# Profit maximisation

--

What is the best choice of price and quantity for the manufacturer?
--
 `\(MRT = MRS\)`

--

&lt;img src="imgs/figure-07-11.svg" width="70%" style="display: block; margin: auto;" /&gt;

---

# Formally

--

.pull-left[
**Demand**

`$$P=f (Q)$$`

where `\(f′(Q)&lt;0\)`

]

.pull-right[

**Firms profit**

`$$\Pi = P\cdot Q - C(Q)$$`

where `\(C′(Q)&gt;0\)`


]

--

choose `\(Q\)` and `\(P\)` to maximize `\(\Pi\)` subject to `\(P=f (Q)\)`

--

$$\Rightarrow \max_{Q} \Pi = f (Q) \cdot Q - C(Q)  $$
--

$$\Rightarrow \frac{d\Pi}{dQ} = f '(Q) \cdot Q + f (Q) - C'(Q) = 0 $$

--

`$$\Rightarrow f '(Q) = \frac{C'(Q) - f (Q)}{Q}$$`
--

`$$\Rightarrow MRT = MRS$$`

---

# Marginal revenue and marginal cost

.pull-left[

&lt;img src="imgs/figure-07-12-a-a.svg" width="100%" style="display: block; margin: auto;" /&gt;

]

.pull-right[

| Quantity | Price | Revenue, `\(R = P \cdot Q\)` |
| -----------------------------------------|
| `\(Q=20\)` | `\(P=6,400\)` | `\(R = 128,000\)` |

]

---

# Marginal revenue and marginal cost

.pull-left[

&lt;img src="imgs/figure-07-12-a-b.svg" width="100%" style="display: block; margin: auto;" /&gt;

]

.pull-right[

| Quantity | Price | Revenue, `\(R = P \cdot Q\)` |
| -----------------------------------------|
| `\(Q=20\)` | `\(P=6,400\)` | `\(R = 128,000\)` |
| `\(Q = 21\)` |	`\(P = 6,320\)` |	`\(R = 132,720\)` |
| `\(ΔQ = 1\)` |	`\(ΔP = 80\)` |	`\(MR = ΔR/ΔQ = 4,720\)` |


]

---

# Marginal revenue and marginal cost

.pull-left[

&lt;img src="imgs/figure-07-12-a-d.svg" width="100%" style="display: block; margin: auto;" /&gt;

]

.pull-right[

| Quantity | Price | Revenue, `\(R = P \cdot Q\)` |
| -----------------------------------------|
| `\(Q=20\)` | `\(P=6,400\)` | `\(R = 128,000\)` |
| `\(Q = 21\)` |	`\(P = 6,320\)` |	`\(R = 132,720\)` |
| `\(ΔQ = 1\)` |	`\(ΔP = 80\)` |	`\(MR = ΔR/ΔQ = 4,720\)` |


- Gain in revenue (21st car): 6,320

- Loss of revenue (80 on each of the other 20 cars): −1,600

- Marginal revenue	4,720

]

--


- **Marginal revenue (MR)** change in revenue from selling an additional unit (net effect of decreasing price and increasing quantity sold)

- Firm maximizes profits by choosing 
point where `\(MR = MC\)`


---

&lt;img src="imgs/figure-07-12-b-a.svg" width="45%" style="display: block; margin: auto;" /&gt;

---

&lt;img src="imgs/figure-07-12-b-b.svg" width="45%" style="display: block; margin: auto;" /&gt;

---

&lt;img src="imgs/figure-07-12-b-c.svg" width="45%" style="display: block; margin: auto;" /&gt;

---

&lt;img src="imgs/figure-07-12-b-d.svg" width="45%" style="display: block; margin: auto;" /&gt;

---

&lt;img src="imgs/figure-07-12-b-e.svg" width="45%" style="display: block; margin: auto;" /&gt;

---

&lt;img src="imgs/figure-07-12-b-f.svg" width="45%" style="display: block; margin: auto;" /&gt;

---

&lt;img src="imgs/figure-07-12-b-g.svg" width="45%" style="display: block; margin: auto;" /&gt;

---

&lt;img src="imgs/figure-07-12-b-i.svg" width="45%" style="display: block; margin: auto;" /&gt;

---
# Price Elasticity of Demand
--

Maximize profit by choosing the point where the slope of the isoprofit curve (MRS) is equal to the slope of the demand curve (MRT),
--
 which represents the trade-off that the firm is constrained to make between price and quantity.
 
--

So the firm’s decision depends on how steep the demand curve is:
--
 in other words, how much consumers’ demand for a good will change if the price changes.
 
--

`$$\varepsilon = - \frac{\% \textit{change in demand}}{\%  \textit{change in price}} = - \frac{100 (\frac{\Delta Q}{Q})}{100 (\frac{\Delta P}{P})}$$`

--

Which functional form for the demand function allow us to estimate price elasticity? 
--
 Logaritmic function.
 
--

`$$ln(Q) = ln(P) \Rightarrow \frac{d ln (Q)}{d Q} = \frac{d ln (P)}{d P} \iff \frac{ \frac{1}{Q}}{d Q} = \frac{\frac{1}{P}}{d P} \iff \frac{d Q}{Q} = \frac{d P}{P}$$`

---

&lt;img src="imgs/figure-07-15-a.svg" width="45%" style="display: block; margin: auto;" /&gt;


Price elasticity changes throughout the demand curve.


`$$\varepsilon = - \frac{100 (\frac{\Delta Q}{Q})}{100 (\frac{\Delta P}{P})}$$`

---

&lt;img src="imgs/figure-07-15-b.svg" width="45%" style="display: block; margin: auto;" /&gt;


|  | A |
| ------------ |
| `\(Q\)` | 20 | 
| `\(P\)` | 6400 | 


---

&lt;img src="imgs/figure-07-15-b.svg" width="45%" style="display: block; margin: auto;" /&gt;


|  | A |
| ------------ |
| `\(Q\)` | 20 | 
| `\(P\)` | 6400 | 
| `\(ΔQ\)` | 1 |
| `\(ΔP\)` | -80 | 

---

&lt;img src="imgs/figure-07-15-b.svg" width="45%" style="display: block; margin: auto;" /&gt;


|  | A |
| ------------ |
| `\(Q\)` | 20 | 
| `\(P\)` | 6400 | 
| `\(ΔQ\)` | 1 |
| `\(ΔP\)` | -80 | 
| % change in Q| `\(100 \cdot (1/20) = 5\)` |
| % change in P| `\(100 \cdot (-80/6400) = −1.25\)`
| `\(\varepsilon\)` | `\(-5/-1.25 = 4\)` | 

---

&lt;img src="imgs/figure-07-15-c.svg" width="45%" style="display: block; margin: auto;" /&gt;


|  | A | B |
| ------------ |
| `\(Q\)` | 20 | 40 |
| `\(P\)` | 6400 | 4800 |
| `\(ΔQ\)` | 1 | 1 |
| `\(ΔP\)` | -80 | -80 | 
| % change in Q| `\(5\)` | `\(2.50\)` |
| % change in P| `\(−1.25\)` | `\(-1.67\)` |
| `\(\varepsilon\)` | `\(4\)` | `\(1.5\)` |

---

&lt;img src="imgs/figure-07-15-d.svg" width="45%" style="display: block; margin: auto;" /&gt;


|  | A | B | C |
| ------------ |
| `\(Q\)` | 20 | 40 | 70 |
| `\(P\)` | 6400 | 4800 | 2400 |
| `\(ΔQ\)` | 1 | 1 | 1 |
| `\(ΔP\)` | -80 | -80 | -80 |  
| % change in Q| `\(5\)` | `\(2.50\)` | `\(1.43\)` |
| % change in P| `\(−1.25\)` | `\(-1.67\)` | `\(−3.33\)` |
| `\(\varepsilon\)` | `\(4\)` | `\(1.5\)` | `\(0.43\)` | 

---

&lt;img src="imgs/figure-07-15-e.svg" width="45%" style="display: block; margin: auto;" /&gt;


|  | A | B | C |
| ------------ |
| `\(Q\)` | 20 | 40 | 70 |
| `\(P\)` | 6400 | 4800 | 2400 |
| `\(ΔQ\)` | 1 | 1 | 1 |
| `\(ΔP\)` | -80 | -80 | -80 |  
| % change in Q| `\(5\)` | `\(2.50\)` | `\(1.43\)` |
| % change in P| `\(−1.25\)` | `\(-1.67\)` | `\(−3.33\)` |
| `\(\varepsilon\)` | `\(4\)` | `\(1.5\)` | `\(0.43\)` | 
| `\(MR = \Delta R / \Delta Q\)` | `\(4,720\)` | `\(1,520\)` | `\(3,280\)` | 

---
# Price Elasticity and Profits

--

A firm’s **markup** (profit margin as a proportion of the price) is *inversely proportional* to price elasticity of demand.

--

.pull-left[
&lt;img src="imgs/figure-07-16.svg" width="100%" style="display: block; margin: auto;" /&gt;
]

.pull-right[
&lt;img src="imgs/figure-07-17.svg" width="100%" style="display: block; margin: auto;" /&gt;
]

---
# Price Elasticity and Policy

--

.pull-left[

&lt;img src="imgs/elasticities.png" width="100%" style="display: block; margin: auto;" /&gt;

]

--

.pull-right[

- The effect of good-specific taxes depends on the elasticity of demand for those goods. 

- Governments raise more tax revenue by levying taxes on price-inelastic goods. 

- Several countries e.g. Denmark and France have introduced taxes on unhealthy foods – to reduce consumption not to raise revenue. 

]

---
# Excercise 
--

.pull-left[
**Total cost function:** `\(C(Q) = 50 + \frac{1}{2} Q^2\)`
]

.pull-right[
**Demand:** `\(Q(P) = 120 - P\)`
]

--

**G**: Graphical solution

**M**: Mathematical solution

--

a. What is the fixed cost? What is the variable cost? What is the marginal cost? What is the average cost? **G**, **M**

--

b. Graph the demand curve. What is the feasible set for the firm's profit maximization? **G**

--

c. Graph the AC and MC. At what quantity is AC at its minimum? Where AC and MC are equal? What would be the shape of the firms isoprofit curves? **G**

--

d. What is the condition to obtain the quantity and price equilibrium? Obtain the equilibrium quantity. Obtain the price quantity. **G**, **M**

--

e. How we could find the equilibrium graphically? **G**

--

e. What is the price elasticity at the equilibrium? **M**


---

We are gonna use R and `tidyverse` to solve graphically the exercise. 
--
 To learn more: https://www.tidyverse.org/learn/.
 
--


```r
# Load tidyverse and tidyr packages
# if it is your first time in using them first write: install.packages(tidyverse) and install.packages(tidyr)
library(tidyverse)
library(tidyr)

# We set a theme for the graphs
theme_set(theme_classic())

data &lt;- 
  tibble(
    q = seq(1,120)
  )

data
## # A tibble: 120 × 1
##        q
##    &lt;int&gt;
##  1     1
##  2     2
##  3     3
##  4     4
##  5     5
##  6     6
##  7     7
##  8     8
##  9     9
## 10    10
## # … with 110 more rows
```


---

Given we've solved mathematically the model, we are going to use the ecuations:

--


```r
data &lt;-  
  data %&gt;% 
  mutate(
    # Average cost function
    ac = 50/q + (.5*q),
    # Marginal cost function
    mc = q,
    # (Inverse) Demand function
    p = 120 - q
  )

data
## # A tibble: 120 × 4
##        q    ac    mc     p
##    &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;
##  1     1  50.5     1   119
##  2     2  26       2   118
##  3     3  18.2     3   117
##  4     4  14.5     4   116
##  5     5  12.5     5   115
##  6     6  11.3     6   114
##  7     7  10.6     7   113
##  8     8  10.2     8   112
##  9     9  10.1     9   111
## 10    10  10      10   110
## # … with 110 more rows
```

---

Let's plot the demand curve:

--


```r
data %&gt;% pivot_longer(!q) %&gt;% 
  # We only wanna see the demand curve
  filter(name == "p") %&gt;% 
  # We use ggplot canvas
  ggplot(aes(q, value, color = name)) + geom_line() + geom_point(size = .1) + labs(x = "Q", y = "P", color = "Curve")
```

&lt;img src="core-unit7_files/figure-html/unnamed-chunk-53-1.png" width="65%" style="display: block; margin: auto;" /&gt;

---

Let's plot the average cost curve:

--


```r
data %&gt;% pivot_longer(!q) %&gt;% 
  # We only wanna see the AC curve
  filter(name == "ac") %&gt;% 
  # We use ggplot canvas
  ggplot(aes(q, value, color = name)) + geom_line() + geom_point(size = .1) + labs(x = "Q", y = "P", color = "Curve")
```

&lt;img src="core-unit7_files/figure-html/unnamed-chunk-54-1.png" width="65%" style="display: block; margin: auto;" /&gt;

---

Let's plot the average cost curve more closely:


```r
data %&gt;% pivot_longer(!q) %&gt;% 
  # We only wanna see the AC curve
  filter(name == "ac") %&gt;% 
  # We only focus in Q values around AC shifts its slope
  filter(q %in% seq(5,20)) %&gt;% 
  # We use ggplot canvas
  ggplot(aes(q, value, color = name)) + geom_line() + geom_point(size = .1) + labs(x = "Q", y = "P", color = "Curve") 
```

&lt;img src="core-unit7_files/figure-html/unnamed-chunk-55-1.png" width="65%" style="display: block; margin: auto;" /&gt;

---

Let's plot the average cost and marginal cost curve:

--


```r
data %&gt;% pivot_longer(!q) %&gt;% 
  # We only wanna see the AC and MC curve
  filter(name != "p") %&gt;% 
  # We use ggplot canvas
  ggplot(aes(q, value, color = name)) + geom_line() + geom_point(size = .1) + labs(x = "Q", y = "P", color = "Curve") 
```

&lt;img src="core-unit7_files/figure-html/unnamed-chunk-56-1.png" width="65%" style="display: block; margin: auto;" /&gt;

---

Let's plot the average cost and marginal cost curve more closely:



```r
data %&gt;% pivot_longer(!q) %&gt;% 
  # We only wanna see the AC and MC curve
  filter(name != "p") %&gt;% 
    # We only focus in Q values around AC shifts its slope
  filter(q %in% seq(5,20)) %&gt;% 
  # We use ggplot canvas
  ggplot(aes(q, value, color = name)) + geom_line() + geom_point(size = .1) + labs(x = "Q", y = "P", color = "Curve") + coord_cartesian(ylim = c(8,12)) +
  geom_vline(xintercept = 10, linetype = "dashed") + geom_hline(yintercept = 10, linetype = "dashed") 
```

&lt;img src="core-unit7_files/figure-html/unnamed-chunk-57-1.png" width="65%" style="display: block; margin: auto;" /&gt;

---

Let's compute the revenue and marginal revenue:


```r
data &lt;-  
  data %&gt;% 
  mutate(
    # Revenue or profit
    revenue = p * q,
    # Marginal revenue Δ R / Δ Q
    mr = (revenue - dplyr::lag(revenue))/(1)
  ) 

data
## # A tibble: 120 × 6
##        q    ac    mc     p revenue    mr
##    &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
##  1     1  50.5     1   119     119    NA
##  2     2  26       2   118     236   117
##  3     3  18.2     3   117     351   115
##  4     4  14.5     4   116     464   113
##  5     5  12.5     5   115     575   111
##  6     6  11.3     6   114     684   109
##  7     7  10.6     7   113     791   107
##  8     8  10.2     8   112     896   105
##  9     9  10.1     9   111     999   103
## 10    10  10      10   110    1100   101
## # … with 110 more rows
```

---

Let's plot everything together (but the total revenue)


```r
data %&gt;% select(-revenue) %&gt;% pivot_longer(!q) %&gt;% 
  # We use ggplot canvas
  ggplot(aes(q, value, color = name)) + geom_line() + geom_point(size = .1) + labs(x = "Q", y = "P", color = "Curve") + coord_cartesian(ylim = c(0,120))
```

&lt;img src="core-unit7_files/figure-html/unnamed-chunk-59-1.png" width="65%" style="display: block; margin: auto;" /&gt;

---

Let's plot everything together (but the total revenue)

&lt;img src="core-unit7_files/figure-html/unnamed-chunk-60-1.png" width="100%" style="display: block; margin: auto;" /&gt;

---

Let's plot everything together (but the total revenue)

&lt;img src="core-unit7_files/figure-html/unnamed-chunk-61-1.png" width="100%" style="display: block; margin: auto;" /&gt;

---

Let's plot everything together (but the total revenue)

&lt;img src="core-unit7_files/figure-html/unnamed-chunk-62-1.png" width="100%" style="display: block; margin: auto;" /&gt;

---

Let's plot everything together (but the total revenue)

&lt;img src="core-unit7_files/figure-html/unnamed-chunk-63-1.png" width="100%" style="display: block; margin: auto;" /&gt;
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
